---
title: Internationalization routing (experimental)
description: Learn how to use i18n routing in Astro.
i18nReady: false
---

import FileTree from '~/components/FileTree.astro'

Astro internationalization (i18n) routing provides a set functionalities to help building localised websites. 

By default, internationalization routing functionalities are all turned off and the user needs to manually opt in them.

## Glossary

The current page will use some specific terminology related to internationalization:
- Locale: a code that represents a language.
- Localized folder: a folder/directory that is named after a locale.



## Basic Usage

1. Enable the routing via configuration

   ```js title="astro.config.mjs"
   import { defineConfig } from "astro/config"
   export default defineConfig({
     experimental: {
       i18n: {
         defaultLocale: "en",
         locales: ["es", "en", "fr"]
       }
     }
   })
   ```
2. Create the folders and pages will contain the translated pages
    <FileTree>
    - src
      - pages
        - en
          - index.astro
        - es
          - index.astro
        - fr
          - index.astro
    </FileTree>

    :::note
    The localised folder doesn't need to be at the root of the `pages/` folder.
    :::

3. Use the virtual module [`astro:i18n`](#virtual-module-astroi18n) that will help you compute the correct localised URLs:

    ```astro title="src/pages/es/index.astro"
    ---
    import { getRelativeLocaleUrl } from "astro:i18n";
    
    const gettingStartedUrl = getRelativeLocaleUrl("es", "getting-started"); // /es/getting-started
    ---
  
    
    <a href={gettingStartedUrl}>Got to getting started</a>
    ```

## Virtual module `astro:i18n`

This module provides functions that can help you to create URLs using the locales.

All the functions below take into account the following options, so the returned paths will change based on their values:

- [`base`](/en/reference/configuration-reference/#base)
- [`trailingSlash`](/en/reference/configuration-reference/#trailingslash)
- [`build.format`](/en/reference/configuration-reference/#buildformat)
- [`site`](/en/reference/configuration-reference/#site)

If `i18n.routingStrategy` is equals to `'prefix-other-locales'`, when the functions will process the `i18n.defaultLocale` when passed as input, the returned URLs **won't** contain the `i18n.defaultLocale`.  

### `getRelativeLocaleUrl()`


`getRelativeLocaleUrl(locale: string, path: string, options?: GetLocaleOptions): string`

Use this function to retrieve a relative path for a locale. If the locale doesn't exist, Astro throws an error. 

```astro title="src/pages/en/index.astro"
---
import {getRelativeLocaleUrl} from "astro:i18n";

getRelativeLocaleUrl("fr", ""); // returns /fr
getRelativeLocaleUrl("fr", "getting-started"); // returns /fr/getting-started
getRelativeLocaleUrl("fr_CA", "getting-started", {
  prependWith: "blog"
}); // returns /blog/fr-ca/getting-started

getRelativeLocaleUrl("fr_CA", "getting-started", {
  prependWith: "blog",
  normalizeLocale: false
}); // returns /blog/fr_CA/getting-started

---
```

### `getAbsoluteLocaleUrl()` 

`getAbsoluteLocaleUrl(locale: string, path: string, options?: GetLocaleOptions): string`


Use this function to retrieve an absolute path for a locale _if [`site`] has a value_. If [`site`] isn't, the function returns a relative URL. If the locale doesn't exist, Astro throws an error.


```astro title="src/pages/en/index.astro"
---
import {getAbsoluteLocaleUrl} from "astro:i18n";

// If `site` is set to be `https://example.com`

getAbsoluteLocaleUrl("fr", ""); // returns https://example.com/fr
getAbsoluteLocaleUrl("fr", "getting-started"); // returns https://example.com/fr/getting-started
getAbsoluteLocaleUrl("fr_CA", "getting-started", {
  prependWith: "blog"
}); // returns https://example.com/blog/fr-ca/getting-started

getAbsoluteLocaleUrl("fr_CA", "getting-started", {
  prependWith: "blog",
  normalizeLocale: false
}); // returns https://example.com/blog/fr_CA/getting-started

---
```

### `getRelativeLocaleUrlList()`

It works like [`getRelativeLocaleUrl`](#getrelativelocaleurl), so it returns a list of relative paths for all the locales.


`getRelativeLocaleUrlList(locale: string, options?: GetLocaleOptions): string[]`

### `getAbsoluteLocaleUrlList()`

`getAbsoluteLocaleUrlList(locale: string, options?: GetLocaleOptions): string[]`


It works like [`getAbsoluteLocaleUrl`](#getabsolutelocaleurl), so it returns a list of relative paths for all the locales.


## Routing strategy 

The option `i18n.routingStrategy` allows to change the behaviour of the Astro routes

### `'prefix-other-locales'`

```js title="astro.config.mjs" ins={7}
import { defineConfig } from "astro/config"
export default defineConfig({
  experimental: {
    i18n: {
      defaultLocale: "en",
      locales: ["es", "en", "fr"],
      routingStrategy: "prefix-other-locales"
    }
  }
})
```

This is the **default** value. With this option all the routes *without* locales belong to the default locale (`i18n.defaultLocale`), and the rest of the locales must have their locale code (prefix) in the URL.

- You want to have `example.com/content` for the default locale.
- You want to have `example.com/es/content` for the other locales.
- You want to have `example.com/` to redirect (302 status code) to `example.come/<i18n.defaultLocale>`.

### `'prefix-always'`

```js title="astro.config.mjs" ins={7}
import { defineConfig } from "astro/config"
export default defineConfig({
  experimental: {
    i18n: {
      defaultLocale: "en",
      locales: ["es", "en", "fr"],
      routingStrategy: "prefix-always"
    }
  }
})
```

With this option, all the routes must have their locale code (prefix) in URL.

- You want to have `example.com/[locale]/content` for all routes.
- You want `example.com/content` to return a 404 (not found) status code.


## Browser language detection

When i18n routing is enabled, two new properties are available via [`Astro` global object](/en/reference/api-reference/#astro-global). These values are **only available in SSR**.

The values are calculated by deducing the languages supported by the browser - via the [`Accept-Language`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language) header -  and the locales supported by the website using [`i18n.locales`].

- `Astro.preferredLocale`: it's the locale requested by the browser and supported by the website. The value is `undefined` if:
  - The browser/user didn't set any preference.
  - The languages of the browser aren't part of [`i18n.locales`].


- `Astro.preferredLocaleList`: it's the locales requested by the browser and supported by the website. The value is `[]` if the languages of the browser aren't part of [`i18n.locales`]. The value is [`i18n.locales`] if the browser/user didn't specify any preference.
  

## Fallback

The fallback is a feature that allows to redirect a user from one locale to another. This is useful when pages of a locale miss, but you want to still provide some content to the user.

For example, we can tell Astro that when a route of the `pt` locale is missing, to redirect to the same route under the `es` locale, when you run the command `astro build`, Astro will create all the missing pages from `src/pages/pt/` that are in `src/pagess/es/`, and those pages will direct to the relative `es` locale.

```js title="astro.config.mjs" ins={6,7-9} ins=", \"pt\""
import { defineConfig } from "astro/config"
export default defineConfig({
  experimental: {
    i18n: {
      defaultLocale: "en",
      locales: ["es", "en", "fr", "pt"],
      fallback: {
        pt: "es"  
      }
    }
  }
})
```

If you have two pages in the `es/` folder, `index.astro` and `guide.astro`, and only one page in the `pt/` folder, `index.astro`; you run the command `astro build`, and in the `dist/pt/` folder you will have two pages: `index.html` with the contents of `index.astro`, and `guide.html`, which will redirect to `es/guide.html`:

<FileTree>
- dist
    - es
        - index.html
        - guide
            - index.html
    - pt
        - index.html
        - guide
            - index.html
  - pages
    - es
      - index.astro
      - guide.astro
    - pt
      - index.astro
</FileTree>



[`site`]: /en/reference/configuration-reference/#site
[`i18n.locales`]: /en/reference/configuration-reference/#experimentali18nlocales
