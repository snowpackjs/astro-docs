---
title: Deploy your Astro Site to Google Cloud
description: How to deploy your Astro site to the web using Google Cloud.
layout: ~/layouts/DeployGuideLayout.astro
i18nReady: true
---

[Google Cloud](https://cloud.google.com/) is a full-featured web app hosting platform that can be used to deploy an Astro site.

## How to deploy

Deploying a project to Google Cloud requires some UI clicks. (Most of these actions can also be done using the [gcloud CLI](https://cloud.google.com/sdk/gcloud/)).

### Cloud Run (SSR and static)

Cloud Run is a serverless platform that allows you to run a container without having to manage any infrastructure. It can be used to deploy both static and SSR sites.

#### 1. Preparing the service

1. Create a new GCP project, or select one you already have.

2. Make sure the Cloud Run API is enabled.

3. Create a new service.

4. Make an empty `Dockerfile` in the root of your project.

#### 2. Building the container

There are a couple of ways to build the container:

- Locally using Docker
- Using [Cloud Build](https://cloud.google.com/build)
- Using any other CI/CD tool (e.g. [GitHub Actions](<https://docs.github.com/en/actions/publishing-packages/publishing-docker-images>))

##### Dockerfile for static sites (example)

This following Dockerfile will build your site and serve it using Apache HTTPD (default config) on port `80`.

```docker title="Dockerfile"
FROM node:lts as build
WORKDIR /app
COPY . .
RUN npm i
RUN npm run build

FROM httpd:2.4 as runtime
COPY --from=build /app/dist /usr/local/apache2/htdocs/
EXPOSE 80
```

:::note[notes]
If you're using a package manager other than `npm`, you'll need to change the commands:

```docker title="Dockerfile" add={4} "pnpm"
FROM node:lts as build
WORKDIR /app
COPY . .
RUN npm i -g pnpm@latest
RUN pnpm i
RUN pnpm run build
...
```

:::

##### Dockerfile for SSR sites (example)

This following Dockerfile will build your site and serve it using Node.js (SSR adapter) on port `3000`.

```docker title="Dockerfile"
FROM node:lts as runtime
WORKDIR /app

COPY . .

RUN npm install
RUN npm run build

ENV HOST=0.0.0.0
ENV PORT=3000
EXPOSE 3000
CMD node ./dist/server/entry.mjs
```

:::tip[Keep this in mind]
These are just examples of Dockerfiles. You can customize them to your needs. For example, you could use another image, like `node:lts-alpine`.

```docker title=".Dockerfile del={1} add={2}
FROM node:lts as runtime
FROM node:lts-alpine as runtime
```
:::

#### 3. Deploying the container

Deployment can be handled manually in terminal or automatically using [Cloud Build](https://cloud.google.com/build) or any other CI/CD system.

:::note[Need public access?]
Don't forget to add the permission `Cloud Run Invoker` to the `allUsers` group in the Cloud Run permissions settings!
:::

### Cloud Storage (static only)

1. Create a new GCP project, or select one you already have.

2. Create a new bucket under [Cloud Storage](https://cloud.google.com/storage).

3. Give it a name and other required settings.

4. Upload your `dist` folder into it or upload using [Cloud Build](https://cloud.google.com/build).

5. Enable public access by adding a new permission to `allUsers` called `Storage Object Viewer`.

6. Edit the website configuration and add `Ã¬ndex.html` as entrypoint and `404.html` as errorpage.
