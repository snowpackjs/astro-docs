---
title: Scripts et gestion d'√©v√®nements.
description: >-
  Comment ajouter de l'interactivit√© c√¥t√© client aux composants Astro en utilisant les 
  API JavaScript natives du navigateur.
layout: ~/layouts/MainLayout.astro
i18nReady: true
---

Vous pouvez ajouter de l'interactivit√© √† vos composants Astro sans [utiliser un framework UI](/fr/core-concepts/framework-components/) comme React, Svelte, Vue, etc. en utilisant le HTML tag `<script>`. Cela vous permet d'envoyer JavaScript pour ex√©cuter dans le navigateur et ajouter des fonctionnalit√©s √† vous composants Astro.

## Utilisation du `<script>` en Astro.

In `.astro` files, you can add client-side JavaScript by adding one (or more) `<script>` tags.
Dans les fichiers `.astro`, vous pouvez ajouter du JavaScript c√¥t√© client en ajoutant un (ou plusieurs) tags `<script>`.

Dans cet example, l'ajout du composant `<Hello />` √† un page enregistrera un message sur la console du navigateur.

```astro title="src/compnonents/Hello.astro"
<h1>Bienvenue, monde!</h1>

<script>
  console.log('Bienvenue, console du navigateur!');
</script>
```

### Regroupement de script

Par d√©faut, les tags `<script>` sont process√©s par Astro.

- Quelques importations seront group√©es, vous permettant d'importer des fichiers locaux ou des modules Node.
- Le script trait√© sera inject√© dans le `<head>` de votre page HTML avec [`type="module"`](https://developer.mozilla.org/fr/docs/Web/JavaScript/Guide/Modules).
- TypeScript est enti√®rement support√©, y compris l'importation de fichiers TypeScript.
- Si votre composant est utilis√© plusieurs fois sur un page, le script ne sera inclus qu'une seule fois.

```astro title="src/components/Example.astro"
<script>
  // Process√©! Regroup√©! TypeScript support√©!
  // L'importation de fichiers locaux et de modules Node est support√©e.
<script>
```

Pour √©viter le regroupement de script, vous pouvez utiliser la directive `is:line`.

``` astro title:"src/components/InlineScript.astro" "is:line"
<script is:line>
  // Sera rendu dans le HTML exactement comme √©crit.
  // Les imports lacales ne sont pas r√©solues et ne fonctionneront pas.
  // Si dans un composant, r√©p√®te chaque fois que le composant est utilis√©.
</script>
```

:::note
L'ajout de `type=module` ou d'un attribut autre que `src` √† un tag `<script>` d√©sactivera le comportement de regroupement par d√©faut d'Astro, traitant le tag comme s'il avait une directive `is:line`.
:::

üìö Consultez notre [directives reference](/fr/reference/directives-reference/#script--style-directives) pour plus d'information sur les directives disponible pour les tags `<script>`.

### Chargement de script

Vous voudriez √©crire vos scripts dans un fichier s√©par√© `.js`/`.ts` ou avoir besoin de r√©f√©rencer un script externe sur un autre serveur. Vous pouvez le faire en les r√©f√©ren√ßant dans l'attribut `src`d'un tag `<script>`.

### Importer des scripts locaux

**Quand l'utiliser:** Si vos script est dedans `src/`

Astro va construire, optimiser et ajouter ces scripts √† la pages pour vous, en suivant ses [r√®gles de regroupement de script](#regroupement-de-script)

```astro title="src/components/LocalScripts.astro"
<!-- chemin relatif vers script √† `src/scripts/local.js` -->
<script src="../scripts/local.js"></script>

<!-- fonctionne √©galement pour les fichiers TypeScript locaux -->
<script src="./script-with-types.ts"></script>
```
#### Charger des scripts externes

**Quand l'utiliser:** Si votre fichier JavaScript se trouve √† l'int√©rieur de `public/` ou sur un CDN.

Pour charger des scripts en dehors du dossier `src/` de votre projet, incluez la directive `is:inline`. Cette approche √©vite le traitement JavaScript, le regroupement et les optimisations qui sont fournis par Astro lorsque vous importez des scripts comme d√©crit ci-dessus.

```astro title="src/components/ExternalScripts.astro" "is:inline"
<!-- chemin absolu vers script √† `src/scripts/local.js` -->
<script is:inline src="/my-script.js"></script>

<!-- full URL to a script on a remote server -->
<!-- URL compl√®te vers un script sur un serveur distant -->
<script is:inline src="https://my-analytics.com/script.js"></script>
```

## Mod√®les communs de script

### G√©rer les √©v√®nements `onclick` et autres

Certains frameworks d'interface utilisent une syntaxe personnalis√©e pour la gestion d'√©v√©nements comme `onClick={...}`  (React/Preact) ou `@click="..."` (Vue). Astro suit le HTML standard de plus pr√®s et n‚Äôutilise pas de syntaxe personnalis√©e pour les √©v√©nements.

Au lieu de cela, vous pouvez utiliser [`addEventListener`](https://developer.mozilla.org/fr/docs/Web/API/EventTarget/addEventListener) dans un tag `<script>` pour g√©rer les interactions utilisateur.

```astro title="src/components/AlertButton.astro"
<button class="alert">Cliquez-moi!</button>

<script>
  // Trouver tous les boutons avec la classe `alert` sur la page.
  const buttons = document.querySelectorAll('button.alert');

  // G√©rer les clics sur chaque bouton.
  buttons.forEach((button) => {
    button.addEventListener('click', () => {
      alert('Button was clicked!');
    });
  });
</script>
```

:::note
Si vous avez plusieurs composants `<AlertButton />` sur une page, Astro n'ex√©cutera pas le script plusieurs fois. Les scripts son group√©s et inclus seulement une fois par page. L'utilisation de `querySelectorAll` de s'assurer que ce script associe l'√©coteur d'√©v√®nements √† chaque bouton avec la classe `alert` trouv√© sur la page.
:::

### Composants Web avec √©l√©ments personnalis√©s

Vous pouvez cr√©er vos propres √©l√©ments HTML avec un comportement personnalis√© en utilisant le standard Composants Web. La d√©finition d'un [√©l√©ment personnalis√©](https://developer.mozilla.org/fr/docs/Web/Web_Components/Using_custom_elements) dans un composant `.astro` vous permet de cr√©er des composants interactifs sans avoir besoin d'une biblioth√®que de cadres d'interface utilisateur.

Dans cet exemple, nous d√©finissons un nouvel √©l√©ment HTML `<astro-heart>` qui suit le nombre de fois que vous cliquez sur le bouton c≈ìur et met √† jour le `<span>` avec le dernier d√©compte.

```astro title="src/components/AstroHeart.astro"
<!-- Enveloppez les √©l√©ments dans notre √©l√©ment personnalis√© "astro-heart" -->
<astro-heart>
  <button aria-label="Heart">üíú</button> √ó <span>0</span>
</astro-heart>

<script>
  // Define le comportement pour notre nouveau type d'√©l√©ment HTML.
  class AstroHeart extends HTMLElement {
    constructor() {
			super();
      let count = 0;

      const heartButton = this.querySelector('button');
      const countSpan = this.querySelector('span');

      // Chaque fois que le bouton est cliqu√©, met √† jour le d√©compte.
			heartButton.addEventListener('click', () => {
        count++;
        countSpan.textContent = count;
      });
		}
  }

  // Dites au navigateur d'utiliser notre classe AstroHeart pour les √©l√©ments <astro-heart>.
  customElements.define('astro-heart', AstroHeart);
</script>
```

Il y a deux avantages √† utiliser un √©l√©ment personnalis√© ici:

1. Au lieu de chercher dans toute la page en utilisant `document.querySelector()`, vous pouvez utiliser `this.querySelector()`, qui ne recherche que dans l'instance courante de l'√©l√©ment personnalis√©. Cela facilite le travail avec seulement les enfants d'une instance de composant √† la fois.

2. Bien qu'un script ne s'ex√©cute qu'une seule fois, le navigateur ex√©cutera la m√©thode `constructor()` de notre √©l√©ment personnalis√© chaque fois qu'il trouvera `<astro-heart>` sur la page. Cela signifie que vous pouvez √©crire du code en toute s√©curit√© pour un composant √† la fois, m√™me si vous avez l'intention d'utiliser ce composant plusieurs fois sur une page.

Vous pouvez en savoir plus sur les √©l√©ments personnalis√©s dans [guide des composants Web r√©utilisables de web.dev](https://web.dev/custom-elements-v1/) et [Introduction aux composants personnalis√©s de MDN](https://developer.mozilla.org/fr/docs/Web/Web_Components/Using_custom_elements).

### Passer les variables frontmatter aux scripts

Dans Astro components, le code dans [le frontmatter](/fr/core-concepts/astro-components/#le-script-du-composant) entre les cl√¥tures ‚Äú---‚Äù tourne sur le serveur et n'est pas disponible dans le navigateur. Pour envoyer des variables du serveur au client, nous avons besoin d'un moyen de stocker nos variables et de les lire lorsque JavaScript s'ex√©cute dans le navigateur.

Une fa√ßon de le faire est d'utiliser [attributs `data-*`](https://developer.mozilla.org/fr/docs/Learn/HTML/Howto/Use_data_attributes) pour stocker la valeur des variables dans votre sortie HTML. Les scripts, y compris les √©l√©ments personnalis√©s, peuvent alors lire ces attributs en utilisant la propri√©t√© `dataset` d'un √©l√©ment une fois que votre HTML se charge dans le navigateur.

Dans cet exemple de composant, un prop `message` est stock√© dans un attribut `data-message`, de sorte que l'√©l√©ment personnalis√© peut lire `this.dataset.message` et obtenir la valeur du prop dans le navigateur.

```astro title="src/components/AstroGreet.astro" {2} /data-message={.+}/ "this.dataset.message"
---
const { message = 'Welcome, world!' } = Astro.props;
---

<!-- Stocker le prop de message comme attribut de donn√©es. -->
<astro-greet data-message={message}>
  <button>Saluer!</button>
</astro-greet>

<script>
  class AstroGreet extends HTMLElement {
    constructor() {
			super();

      // Lisez le message de l‚Äôattribut data..
      const message = this.dataset.message;
      const button = this.querySelector('button');
      button.addEventListener('click', () => {
        alert(message);
      });
		}
  }

  customElements.define('astro-greet', AstroGreet);
</script>
```

Maintenant, nous pouvons utiliser notre composant plusieurs fois et √™tre accueillis par un message diff√©rent pour chacun.

```astro title="src/pages/example.astro"
---
import AstroGreet from '../components/AstroGreet.astro';
---

<!-- Utilisez le message par d√©faut: "Bienvenue, monde!" -->
<AstroGreet />

<!-- Utiliser des messages personnalis√©s pass√©s comme prop. -->
<AstroGreet message="Lovely day to build components!" />
<AstroGreet message="Glad you made it! üëã" />
```

:::tip[Saviez-vous?]
C'est en fait ce que fait Astro dans les coulisses lorsque vous passez des accessoires √† un composant √©crit en utilisant un framework d'interface utilisateur comme React! Pour les composants avec une directive `client:*`, Astro cr√©e un √©l√©ment personnalis√© `<astro-island>` avec un attribut `props` qui stocke vos props c√¥t√© serveur dans la sortie HTML.
:::
